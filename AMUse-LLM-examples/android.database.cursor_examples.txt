public boolean queryIsExist(String id) { Cursor cursor = db.query(MediaChannelTable.TABLENAME, null, MediaChannelTable.ID + "=?", new String[]{id}, null, null, null); if (cursor.moveToNext()) { cursor.close(); return true; } cursor.close(); return false; }
public boolean queryisExist(String keyWord) { Cursor cursor = db.query(SearchHistoryTable.TABLENAME, null, SearchHistoryTable.KEYWORD + "=?", new String[]{keyWord}, null, null, null); if (cursor.moveToNext()) { cursor.close(); return true; } cursor.close(); return false; }
public static void logTableDump(SQLiteDatabase db, String tablename) { Cursor cursor = db.query(tablename, null, null, null, null, null, null); try { String dump = DatabaseUtils.dumpCursorToString(cursor); DaoLog.d(dump); } finally { cursor.close(); } }
public boolean isRead(String table, String key, int value) { boolean isRead = false; Cursor cursor = mSQLiteDatabase.query(table, null, "key=?", new String[]{key}, null, null, null); if (cursor.moveToNext() && (cursor.getInt(cursor.getColumnIndex("is_read")) == value)) { isRead = true; } cursor.close(); return isRead; }
public void insertHasRead(String table, String key, int value) { Cursor cursor = mSQLiteDatabase.query(table, null, null, null, null, null, "id asc"); if (cursor.getCount() > 200 && cursor.moveToNext()) { mSQLiteDatabase.delete(table, "id=?", new String[]{String.valueOf(cursor.getInt(cursor.getColumnIndex("id")))}); } cursor.close(); ContentValues contentValues = new ContentValues(); contentValues.put("key", key); contentValues.put("is_read", value); mSQLiteDatabase.insertWithOnConflict(table, null, contentValues, SQLiteDatabase.CONFLICT_REPLACE); }
@Override public SourceInfo get(String url) { checkNotNull(url); Cursor cursor = null; try { cursor = getReadableDatabase().query(TABLE, ALL_COLUMNS, COLUMN_URL + "=?", new String[]{url}, null, null, null); return cursor == null || !cursor.moveToFirst() ? null : convert(cursor); } finally { if (cursor != null) { cursor.close(); } } }
public List<SearchHistoryBean> queryAll() { Cursor cursor = db.query(SearchHistoryTable.TABLENAME, null, null, null, null, null, SearchHistoryTable.TIME + " desc"); List<SearchHistoryBean> list = new ArrayList<>(); while (cursor.moveToNext()) { SearchHistoryBean bean = new SearchHistoryBean(); bean.setKeyWord(cursor.getString(SearchHistoryTable.ID_KEYWORD)); bean.setTime(cursor.getString(SearchHistoryTable.ID_TIME)); list.add(bean); } cursor.close(); return list; }
protected int getRowsCount(String tableName) { int count = 0; Cursor c = Connector.getDatabase().query(tableName, null, null, null, null, null, null); count = c.getCount(); c.close(); return count; }
protected boolean isDataExists(String table, long id) { SQLiteDatabase db = Connector.getDatabase(); Cursor cursor = null; try { cursor = db.query(table, null, "id = ?", new String[] { String.valueOf(id) }, null, null, null); return cursor.getCount() == 1 ? true : false; } catch (Exception e) { e.printStackTrace(); } finally { if (cursor != null) { cursor.close(); } } return false; }
protected long getForeignKeyValue(String tableWithFK, String tableWithoutFK, long id) { Cursor cursor = Connector.getDatabase().query(tableWithFK, null, "id = ?", new String[]{String.valueOf(id)}, null, null, null); long foreignKeyId = 0; if (cursor.moveToFirst()) { foreignKeyId = cursor.getLong(cursor.getColumnIndexOrThrow(BaseUtility.changeCase(tableWithoutFK + "_id"))); } cursor.close(); return foreignKeyId; }
private void assertMessageWithSubjectExists(SQLiteDatabase database, String subject) { Cursor cursor = database.query("messages", new String[] { "subject" }, null, null, null, null, null); try { assertTrue(cursor.moveToFirst()); assertEquals(subject, cursor.getString(0)); } finally { cursor.close(); } }
@Test public void testCreateAndAlterTable() throws Exception { SQLiteDatabase db = openOrCreateDatabase("db1"); db.execSQL("CREATE TABLE foo(id INTEGER PRIMARY KEY AUTOINCREMENT, data TEXT);"); Cursor c = db.query("FOO", null, null, null, null, null, null); assertThat(c).isNotNull(); c.close(); db.close(); db = openOrCreateDatabase("db1"); db.execSQL("ALTER TABLE foo ADD COLUMN more TEXT NULL;"); c = db.query("FOO", null, null, null, null, null, null); assertThat(c).isNotNull(); int moreIndex = c.getColumnIndex("more"); assertThat(moreIndex).isAtLeast(0); c.close(); }
protected Classroom getClassroom(long id) { Classroom c = null; Cursor cursor = Connector.getDatabase().query(getTableName(Classroom.class), null, "id = ?", new String[] { String.valueOf(id) }, null, null, null); if (cursor.moveToFirst()) { c = new Classroom(); String name = cursor.getString(cursor.getColumnIndexOrThrow("name")); c.setName(name); } cursor.close(); return c; }
@Test public void testCreateAndDropTable() throws Exception { SQLiteDatabase db = openOrCreateDatabase("db1"); db.execSQL("CREATE TABLE foo(id INTEGER PRIMARY KEY AUTOINCREMENT, data TEXT);"); Cursor c = db.query("FOO", null, null, null, null, null, null); assertThat(c).isNotNull(); c.close(); db.close(); db = openOrCreateDatabase("db1"); db.execSQL("DROP TABLE IF EXISTS foo;"); try { c = db.query("FOO", null, null, null, null, null, null); fail("expected no such table exception"); } catch (SQLiteException e) { // TODO } db.close(); }
protected IdCard getIdCard(long id) { IdCard card = null; Cursor cursor = Connector.getDatabase().query(getTableName(IdCard.class), null, "id = ?", new String[] { String.valueOf(id) }, null, null, null); if (cursor.moveToFirst()) { card = new IdCard(); String address = cursor.getString(cursor.getColumnIndexOrThrow("address")); String number = cursor.getString(cursor.getColumnIndexOrThrow("number")); card.setAddress(address); card.setNumber(number); } cursor.close(); return card; }
protected Student getStudent(long id) { Student student = null; Cursor cursor = Connector.getDatabase().query(getTableName(Student.class), null, "id = ?", new String[] { String.valueOf(id) }, null, null, null); if (cursor.moveToFirst()) { student = new Student(); String name = cursor.getString(cursor.getColumnIndexOrThrow("name")); int age = cursor.getInt(cursor.getColumnIndexOrThrow("age")); student.setName(name); student.setAge(age); } cursor.close(); return student; }
protected List<Student> getStudents(int[] ids) { List<Student> students = new ArrayList<Student>(); Cursor cursor = Connector.getDatabase().query(getTableName(Student.class), null, getWhere(ids), null, null, null, null); if (cursor.moveToFirst()) { Student s = new Student(); String name = cursor.getString(cursor.getColumnIndexOrThrow("name")); int age = cursor.getInt(cursor.getColumnIndexOrThrow("age")); s.setName(name); s.setAge(age); students.add(s); } cursor.close(); return students; }
@Test public void testUpdateAllRowsWithInstanceUpdate() { Cursor c = Connector.getDatabase().query(studentTable, null, null, null, null, null, null); int allRows = c.getCount(); c.close(); Student student = new Student(); student.setName("Zuckerburg"); int affectedRows = student.updateAll(); assertEquals(allRows, affectedRows); }
protected Computer getComputer(long id) { Computer computer = null; Cursor cursor = Connector.getDatabase().query(getTableName(Computer.class), null, "id = ?", new String[] { String.valueOf(id) }, null, null, null); if (cursor.moveToFirst()) { computer = new Computer("", 0); double newPrice = cursor.getDouble(cursor.getColumnIndexOrThrow("price")); String brand = cursor.getString(cursor.getColumnIndexOrThrow("brand")); computer.setBrand(brand); computer.setPrice(newPrice); } cursor.close(); return computer; }
protected Cellphone getCellPhone(long id) { Cellphone cellPhone = null; Cursor cursor = Connector.getDatabase().query(getTableName(Cellphone.class), null, "id = ?", new String[] { String.valueOf(id) }, null, null, null); if (cursor.moveToFirst()) { cellPhone = new Cellphone(); double newPrice = cursor.getDouble(cursor.getColumnIndexOrThrow("price")); char inStock = cursor.getString(cursor.getColumnIndexOrThrow("instock")).charAt(0); String brand = cursor.getString(cursor.getColumnIndexOrThrow("brand")); cellPhone.setBrand(brand); cellPhone.setInStock(inStock); cellPhone.setPrice(newPrice); } cursor.close(); return cellPhone; }