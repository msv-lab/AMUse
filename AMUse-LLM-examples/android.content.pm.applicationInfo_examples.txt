if (file.getPath().endsWith(".apk")) { String filePath = file.getPath(); PackageInfo packageInfo = context.getPackageManager().getPackageArchiveInfo(filePath, PackageManager.GET_ACTIVITIES); if(packageInfo != null) { ApplicationInfo appInfo = packageInfo.applicationInfo; if (Build.VERSION.SDK_INT >= 8) { appInfo.sourceDir = filePath; appInfo.publicSourceDir = filePath; } Drawable icon = appInfo.loadIcon(context.getPackageManager()); bmpIcon = ((BitmapDrawable) icon).getBitmap(); } }
private Drawable getAppIcon(){ Drawable d = getApplicationInfo().loadIcon(act.getPackageManager()); return d; }
private void bindView(int position, View row) { TextView label=(TextView)row.findViewById(R.id.label); label.setText(getItem(position).loadLabel(pm)); ImageView icon=(ImageView)row.findViewById(R.id.icon); icon.setImageDrawable(getItem(position).loadIcon(pm)); } }
private void bindView(int position, View row) { TextView label=row.findViewById(R.id.label); label.setText(getItem(position).loadLabel(pm)); ImageView icon=row.findViewById(R.id.icon); icon.setImageDrawable(getItem(position).loadIcon(pm)); } }
@TargetApi(Build.VERSION_CODES.LOLLIPOP) private static void applyTaskDescription(@NonNull Activity activity, @Nullable String key, int color) { try { ActivityManager.TaskDescription td = new ActivityManager.TaskDescription( (String) activity.getTitle(), ((BitmapDrawable) activity.getApplicationInfo().loadIcon(activity.getPackageManager())).getBitmap(), color); activity.setTaskDescription(td); } catch (Exception ignored) {} }
private void loadIcon(TypedArray a, PackageManager pm, ApplicationInfo appInfo) { if (mContext instanceof Activity) { try { mIcon = pm.getActivityIcon(((Activity) mContext).getComponentName()); } catch (NameNotFoundException e) { Log.e(TAG, "Failed to load app icon.", e); } } if (mIcon == null) { mIcon = appInfo.loadIcon(pm); } }
abAppProcessInfo.isSystem = false; Drawable icon = appInfo.loadIcon(packageManager); String appName = appInfo.loadLabel(packageManager).toString(); appInfo = getApplicationInfo(appProcessInfo.processName.split(":")[0]); if (appInfo != null) { Drawable icon = appInfo.loadIcon(packageManager); abAppProcessInfo.icon = icon; }else{
icon = appInfo.loadIcon(pm); 
abAppProcessInfo.isSystem = false; Drawable icon = appInfo.loadIcon(packageManager); String appName = appInfo.loadLabel(packageManager).toString(); appInfo = getApplicationInfo(context, appProcessInfo.processName.split(":")[0]); Drawable icon = appInfo.loadIcon(packageManager); abAppProcessInfo.icon = icon;
String label = applicationInfo.loadLabel(pm) + ""; Bitmap icon = null; Drawable drawable = applicationInfo.loadIcon(pm); if (drawable instanceof BitmapDrawable) { icon = ((BitmapDrawable) drawable).getBitmap();
CharSequence sequence = appInfo.loadLabel(pm); name = sequence.toString(); icon = BitmapUtils.drawableToBitmap(appInfo.loadIcon(pm)); } catch (Throwable e) { return false;
publishProgress(++mAppCount, packInfos.size()); final AppInfo appInfo = new AppInfo(); Drawable appIcon = packInfo.applicationInfo.loadIcon(pm); appInfo.setAppIcon(appIcon);
Drawable drawable = app.getApplicationInfo().loadIcon(app.getPackageManager()); if (drawable != null) { icon = DrawableUtils.drawableToBitMap(drawable);
private Drawable loadIcon(PackageManager pm) { Drawable icon = weakIcon != null ? weakIcon.get() : null; if (icon == null) { icon = appInfo.loadIcon(pm); weakIcon = new WeakReference<>(icon); } return icon; } }
public String getIconBase64() { String icon = ""; if (mAppInfo != null) { icon = Util.imageToBase64(mAppInfo.loadIcon(pm)); } return icon; }
public static Drawable getApkThumbnail(Context context, String apk_path){ if(context == null){ return null; } PackageManager pm = context.getPackageManager(); PackageInfo packageInfo = pm.getPackageArchiveInfo(apk_path, PackageManager.GET_ACTIVITIES); ApplicationInfo appInfo = packageInfo.applicationInfo; /**获取apk的图标 */ appInfo.sourceDir = apk_path; appInfo.publicSourceDir = apk_path; if(appInfo != null){ Drawable apk_icon = appInfo.loadIcon(pm); return apk_icon; } return null; }
public static Drawable getApkThumbnail(Context context, String apk_path){ if(context == null){ return null; } try{ PackageManager pm = context.getPackageManager(); PackageInfo packageInfo = pm.getPackageArchiveInfo(apk_path, PackageManager.GET_ACTIVITIES); ApplicationInfo appInfo = packageInfo.applicationInfo; /**获取apk的图标 */ appInfo.sourceDir = apk_path; appInfo.publicSourceDir = apk_path; if(appInfo != null){ Drawable apk_icon = appInfo.loadIcon(pm); return apk_icon; } }catch(Exception e){ } return null; }
private ArrayList<ExpandableListItem> getInstalledApps() { ArrayList<ExpandableListItem> appsList = new ArrayList<>(); List<PackageInfo> packs = context.getPackageManager().getInstalledPackages(0); for (int i = 0; i < packs.size(); i++) { android.content.pm.PackageInfo p = packs.get(i); // Installed by user if (mPrefs.getBoolean(Config.SP_SWITCH_OUA, true) ? (p.applicationInfo.flags & 129) == 0 : true) { ExpandableListItem pInfo = new ExpandableListItem(); pInfo.setAppName(p.applicationInfo.loadLabel(context.getPackageManager()).toString()); pInfo.setPckName(p.packageName); pInfo.setIcon(p.applicationInfo.loadIcon(context.getPackageManager())); String pack = mPrefs.getString(Config.SP_PACKAGE, ""); if (p.packageName.trim().equals(pack.trim())) { pInfo.setSelected(true); } appsList.add(pInfo); } } return appsList; }
@Override public void onBindViewHolder(ViewHolder holder, int position) { data = logData.get(position); holder.bind(logData.get(position),recyclerItemClickListener); try { info = Api.getPackageDetails(context, data.getUid()); holder.icon.setImageDrawable(info.applicationInfo.loadIcon(context.getPackageManager())); } catch (Exception e) { info = null; holder.icon.setImageDrawable(context.getResources().getDrawable(R.drawable.ic_unknown)); } try { holder.lastDenied.setText(pretty(new Date(System.currentTimeMillis() - data.getTimestamp()))); } catch (Exception e) { holder.lastDenied.setText("-"); } holder.appName.setText(data.getAppName() != null ? data.getAppName() + "(" + data.getUid() + ")" : context.getString(R.string.log_deletedapp)); if(data.getCount() > 1) { holder.dataDenied.setText(context.getString(R.string.log_denied) + " " + data.getCount() + " " + context.getString(R.string.log_times)) ; } else { holder.dataDenied.setText(context.getString(R.string.log_denied) + " " + data.getCount() + " " + context.getString(R.string.log_time)) ; } }
private void updateTaskDescription() { if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) { String title = getTitle().toString(); Drawable iconDrawable = getApplicationInfo().loadIcon(getPackageManager()); Bitmap icon = iconDrawable instanceof BitmapDrawable ? ((BitmapDrawable) iconDrawable).getBitmap() : null; int colorPrimary; if (position < getCount()) { try { colorPrimary = ContextCompat.getColor(IntroActivity.this, getBackgroundDark(position)); } catch (Resources.NotFoundException e) { colorPrimary = ContextCompat.getColor(IntroActivity.this, getBackground(position)); } } else { TypedValue typedValue = new TypedValue(); TypedArray a = obtainStyledAttributes(typedValue.data, new int[]{R.attr.colorPrimary}); colorPrimary = a.getColor(0, 0); a.recycle(); } colorPrimary = ColorUtils.setAlphaComponent(colorPrimary, 0xFF); setTaskDescription(new ActivityManager.TaskDescription(title, icon, colorPrimary)); } }